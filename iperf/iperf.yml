version: "3.7"

services:
  iperf:
    image: clearlinux/iperf
    #ports:
    #  - target: 5201
    #  - published: 5201
    #  - protocol: tcp
    #  - mode: host
    networks:
      - traefik_public
    deploy:
      labels:
        # traefik common
        - traefik.enable=true
        - traefik.docker.network=traefik_public

        # traefikv2
        - "traefik.http.routers.iam.rule=Host(`iperf.ecom.com.ar`)"
        - "traefik.http.services.iam.loadbalancer.server.port=5201"
        - "traefik.enable=true"

networks:
  traefik_public:
    attachable: true